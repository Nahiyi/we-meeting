import{d as H,r,y as V,n as L,N as F,s as J,w as u,R,S as E,T as O,b as a,c as l,z as h,B as M,t as d,F as y,v as w,e as i,g as k,A as U,f as N,C as q,i as G,h as S,k as K,o,U as P,L as Q}from"./index-Dg42PXJN.js";import{A as W}from"./AppShell-CnOUhuHU.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"history-page"},Z={class:"tab-filter"},ee=["onClick"],te={class:"meeting-list"},ae={key:0,class:"loading-state"},se={key:1,class:"empty-state"},ne={key:2,class:"meeting-cards"},oe={class:"card-header"},le={class:"meeting-name"},ie={class:"card-body"},ce={class:"info-row"},re={class:"info-row"},ue={key:0,class:"card-actions"},de={key:3,class:"load-more"},ve=10,_e=H({name:"History",__name:"History",setup(fe){const T=K(),$=[{label:"全部",value:"all"},{label:"我创建的",value:"created"},{label:"我参加的",value:"joined"}],f=r("all"),c=r([]),v=r(!1),g=r(1),b=r(0),x=V(()=>c.value.length<b.value);async function p(s=!1){s&&(g.value=1,c.value=[]),v.value=!0;try{const e={pageNo:g.value,pageSize:ve};let n;switch(f.value){case"created":n=await O(e);break;case"joined":n=await E(e);break;default:n=await R(e)}s?c.value=n.list:c.value.push(...n.list),b.value=n.total}catch{}finally{v.value=!1}}function z(s){f.value=s,p(!0)}function B(){g.value++,p()}async function I(s){try{const e=localStorage.getItem("nickName")||"用户";await P(s.meetingId,e),await Q({videoOpen:!0}),T.push(`/meeting/${s.meetingId}`)}catch(e){console.error("重新加入会议失败:",e)}}function j(s){const e=new Date(s),n=e.getMonth()+1,_=e.getDate(),t=e.getHours().toString().padStart(2,"0"),m=e.getMinutes().toString().padStart(2,"0");return`${n}月${_}日 ${t}:${m}`}function A(s){switch(s){case 0:return"ongoing";case 1:return"ended";default:return"ended"}}function D(s){switch(s){case 0:return"进行中";case 1:return"已结束";default:return"已结束"}}const C=r(!1);return L(()=>{C.value||(p(),C.value=!0)}),F(()=>{}),(s,e)=>{const n=N("el-icon"),_=N("el-button");return o(),J(W,null,{default:u(()=>[a("div",Y,[e[3]||(e[3]=a("div",{class:"page-header"},[a("h1",{class:"page-title"},"会议记录")],-1)),a("div",Z,[(o(),l(y,null,h($,t=>a("button",{key:t.value,class:M(["tab-btn",{active:f.value===t.value}]),onClick:m=>z(t.value)},d(t.label),11,ee)),64))]),a("div",te,[v.value?(o(),l("div",ae,[(o(),l(y,null,h(3,t=>a("div",{class:"skeleton-card",key:t})),64))])):c.value.length===0?(o(),l("div",se,[i(n,{size:48},{default:u(()=>[i(k(U))]),_:1}),e[0]||(e[0]=a("p",null,"暂无会议记录",-1))])):(o(),l("div",ne,[(o(!0),l(y,null,h(c.value,t=>(o(),l("div",{key:t.meetingId,class:"meeting-card"},[a("div",oe,[a("span",le,d(t.meetingName),1),a("span",{class:M(["status-badge",A(t.status)])},d(D(t.status)),3)]),a("div",ie,[a("div",ce,[i(n,null,{default:u(()=>[i(k(q))]),_:1}),a("span",null,d(j(t.createTime)),1)]),a("div",re,[i(n,null,{default:u(()=>[i(k(G))]),_:1}),a("span",null,"会议号: "+d(t.meetingNo),1)])]),t.status===0?(o(),l("div",ue,[i(_,{type:"primary",size:"small",onClick:m=>I(t)},{default:u(()=>[...e[1]||(e[1]=[S(" 重新加入 ",-1)])]),_:1},8,["onClick"])])):w("",!0)]))),128))])),x.value&&c.value.length>0?(o(),l("div",de,[i(_,{loading:v.value,onClick:B},{default:u(()=>[...e[2]||(e[2]=[S("加载更多",-1)])]),_:1},8,["loading"])])):w("",!0)])])]),_:1})}}}),he=X(_e,[["__scopeId","data-v-4ff9f73b"]]);export{he as default};
