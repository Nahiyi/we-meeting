import{d as I,c as h,b as n,q as ue,t as f,o as p,s as A,v as P,x as ce,y as T,F as J,z as L,e as t,f as _,w as a,g as $,A as G,h as w,B as R,C as z,D as me,r as V,n as K,G as ge,H as O,u as pe,a as E,I as fe,J as _e,k as ve,E as S,K as ye,L as Q,M as ke}from"./index-DSboVXbR.js";import{A as he}from"./AppShell-CC7KQGkw.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{l as we}from"./reserve-B6rzk97X.js";const Me={class:"card-icon"},Ne={class:"card-label"},$e=I({__name:"ActionCard",props:{label:{},icon:{}},emits:["click"],setup(g){return(c,m)=>(p(),h("div",{class:"action-card",onClick:m[0]||(m[0]=v=>c.$emit("click"))},[n("div",Me,[ue(c.$slots,"icon",{},()=>[g.icon?(p(),A(ce(g.icon),{key:0})):P("",!0)],!0)]),n("span",Ne,f(g.label),1)]))}}),D=U($e,[["__scopeId","data-v-ab601649"]]),Ve={class:"schedule-panel"},Ce={class:"schedule-header"},be={class:"date-display"},Se={class:"date-day"},je={class:"date-meta"},Te={class:"date-month"},xe={class:"date-weekday"},De={class:"schedule-content"},Ie={key:0,class:"schedule-loading"},Pe={key:1,class:"schedule-empty"},Ue={key:2,class:"meeting-cards"},qe=["onClick"],Ae={class:"card-status"},Oe={class:"status-text"},ze={class:"card-name"},Be={class:"card-info"},Fe={class:"duration"},He={key:0,class:"card-action"},Je={class:"schedule-footer"},Le=I({__name:"SchedulePanel",props:{meetings:{default:()=>[]},loading:{type:Boolean,default:!1},maxDisplay:{default:5}},emits:["meeting-click","view-all"],setup(g){const c=g,m=new Date,v=T(()=>m.getDate().toString()),y=T(()=>`${m.getMonth()+1}月`),M=T(()=>["周日","周一","周二","周三","周四","周五","周六"][m.getDay()]),N=T(()=>c.meetings.slice(0,c.maxDisplay));function C(s){switch(s){case"ongoing":return"进行中";case"upcoming":return"待开始";case"ended":return"已结束";default:return"待开始"}}function i(s){const l=new Date(s),o=l.getHours().toString().padStart(2,"0"),k=l.getMinutes().toString().padStart(2,"0");return`${o}:${k}`}return(s,l)=>{const o=_("el-icon"),k=_("el-button");return p(),h("div",Ve,[n("div",Ce,[n("div",be,[n("span",Se,f(v.value),1),n("div",je,[n("span",Te,f(y.value),1),n("span",xe,f(M.value),1)])]),l[1]||(l[1]=n("span",{class:"header-title"},"今日会议",-1))]),n("div",De,[g.loading?(p(),h("div",Ie,[(p(),h(J,null,L(2,u=>n("div",{class:"skeleton-card",key:u})),64))])):g.meetings.length===0?(p(),h("div",Pe,[t(o,{size:32},{default:a(()=>[t($(G))]),_:1}),l[2]||(l[2]=n("span",null,"今日暂无会议",-1))])):(p(),h("div",Ue,[(p(!0),h(J,null,L(N.value,u=>(p(),h("div",{key:u.id,class:R(["meeting-card",u.status]),onClick:q=>s.$emit("meeting-click",u)},[n("div",Ae,[n("span",{class:R(["status-dot",u.status])},null,2),n("span",Oe,f(C(u.status)),1)]),n("div",ze,f(u.name),1),n("div",Be,[t(o,null,{default:a(()=>[t($(z))]),_:1}),n("span",null,f(i(u.startTime)),1),n("span",Fe,f(u.duration)+"分钟",1)]),u.status==="ongoing"||u.status==="upcoming"?(p(),h("div",He,[t(k,{size:"small",type:u.status==="ongoing"?"primary":"default",onClick:me(q=>s.$emit("meeting-click",u),["stop"])},{default:a(()=>[w(f(u.status==="ongoing"?"加入会议":"查看详情"),1)]),_:2},1032,["type","onClick"])])):P("",!0)],10,qe))),128))]))]),n("div",Je,[n("a",{class:"view-all",onClick:l[0]||(l[0]=u=>s.$emit("view-all"))},[...l[3]||(l[3]=[w(" 查看全部会议 ",-1),n("span",{class:"arrow"},"→",-1)])])])])}}}),Re=U(Le,[["__scopeId","data-v-0401ae8c"]]),Ee={class:"card-header"},Qe={class:"card-body"},Ge={class:"meeting-name"},Ke={class:"meeting-details"},We={class:"meeting-no"},Xe={class:"meeting-duration"},Ye={class:"card-footer"},Ze=I({__name:"CurrentMeetingCard",props:{meeting:{}},emits:["rejoin"],setup(g,{emit:c}){const m=g,v=c,y=V(0);let M=null;const N=T(()=>{const s=Math.floor(y.value/3600),l=Math.floor(y.value%3600/60),o=y.value%60;return s>0?`${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${l.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`});function C(){var s;if((s=m.meeting)!=null&&s.startTime){const l=new Date(m.meeting.startTime).getTime(),o=Date.now();y.value=Math.floor((o-l)/1e3)}}function i(){m.meeting&&v("rejoin",m.meeting.meetingId)}return K(()=>{C(),M=window.setInterval(()=>{y.value++},1e3)}),ge(()=>{M&&clearInterval(M)}),(s,l)=>{const o=_("el-icon"),k=_("el-button");return g.meeting?(p(),h("div",{key:0,class:"current-meeting-card",onClick:i},[n("div",Ee,[t(o,{class:"pulse-icon",size:20},{default:a(()=>[t($(O))]),_:1}),l[0]||(l[0]=n("span",{class:"status-text"},"进行中的会议",-1))]),n("div",Qe,[n("div",Ge,f(g.meeting.meetingName),1),n("div",Ke,[n("span",We,"会议号: "+f(g.meeting.meetingNo),1),n("span",Xe,[t(o,null,{default:a(()=>[t($(z))]),_:1}),w(" "+f(N.value),1)])])]),n("div",Ye,[t(k,{type:"primary",size:"small",round:""},{default:a(()=>[t(o,null,{default:a(()=>[t($(O))]),_:1}),l[1]||(l[1]=w(" 重新加入 ",-1))]),_:1})])])):P("",!0)}}}),et=U(Ze,[["__scopeId","data-v-be458209"]]),tt={class:"home-page"},nt={class:"home-content"},ot={class:"action-panel"},at={class:"action-grid"},lt=I({__name:"Home",setup(g){const c=ve(),m=pe(),v=V(null),y=V([]),M=V(!1),N=V(!1),C=V(!1),i=E({meetingNoType:0,meetingName:"",joinType:0,joinPassword:""}),s=V(!1),l=V(!1),o=E({meetingNo:"",nickName:"",joinPassword:"",videoOpen:!0});let k=null;async function u(){try{k||(k=fe()),v.value=await k}catch(d){console.error("获取当前会议失败:",d)}finally{k=null}}async function q(){M.value=!0;try{const d=await we();y.value=d.map(e=>({id:e.meetingId,name:e.meetingName,meetingNo:e.realMeetingId||e.meetingId,startTime:e.startTime,duration:e.duration,status:W(e.status),realMeetingId:e.realMeetingId}))}catch(d){console.error("获取今日会议失败:",d)}finally{M.value=!1}}function W(d){switch(d){case 1:return"ongoing";case 2:return"ended";case 3:return"ended";default:return"upcoming"}}function X(d){c.push(`/meeting/${d}`)}function Y(){i.meetingNoType=0,i.meetingName="",i.joinType=0,i.joinPassword=""}function Z(){o.meetingNo="",o.nickName=m.nickName||"",o.joinPassword="",o.videoOpen=!0}function ee(){if(v.value){S.warning("您有正在进行的会议，请先结束或退出当前会议");return}Y(),N.value=!0}function te(){if(v.value){c.push(`/meeting/${v.value.meetingId}`);return}Z(),s.value=!0}function ne(){c.push("/schedule")}function oe(){c.push("/history")}async function ae(){if(!i.meetingName.trim()){S.warning("请输入会议主题");return}C.value=!0;try{const d=await ye({meetingNoType:i.meetingNoType,meetingName:i.meetingName.trim(),joinType:i.joinType,joinPassword:i.joinPassword||void 0});await Q({videoOpen:!0}),S.success("会议创建成功"),N.value=!1,c.push(`/meeting/${d}`)}catch(d){console.error("创建会议失败:",d)}finally{C.value=!1}}async function le(){if(!/^\d{10}$/.test(o.meetingNo)){S.warning("请输入10位会议号");return}if(!o.nickName.trim()){S.warning("请输入昵称");return}l.value=!0;try{const d=await ke({meetingNo:o.meetingNo,nickName:o.nickName.trim(),password:o.joinPassword||void 0});await Q({videoOpen:o.videoOpen}),S.success("加入会议成功"),s.value=!1,c.push(`/meeting/${d}`)}catch(d){console.error("加入会议失败:",d)}finally{l.value=!1}}function se(d){o.meetingNo=d.meetingNo,o.nickName=m.nickName||"",s.value=!0}function ie(){c.push("/history")}return K(()=>{Promise.all([u(),q()])}),(d,e)=>{const B=_("el-radio"),de=_("el-radio-group"),b=_("el-form-item"),j=_("el-input"),F=_("el-form"),x=_("el-button"),H=_("el-dialog"),re=_("el-switch");return p(),A(he,null,{default:a(()=>[n("div",tt,[v.value?(p(),A(et,{key:0,meeting:v.value,onRejoin:X},null,8,["meeting"])):P("",!0),n("div",nt,[n("div",ot,[e[11]||(e[11]=n("div",{class:"panel-header"},[n("h2",{class:"panel-title"},"快速开始")],-1)),n("div",at,[t(D,{label:"加入会议",icon:$(_e),onClick:te},null,8,["icon"]),t(D,{label:"快速会议",icon:$(O),onClick:ee},null,8,["icon"]),t(D,{label:"预定会议",icon:$(G),onClick:ne},null,8,["icon"]),t(D,{label:"历史会议",icon:$(z),onClick:oe},null,8,["icon"])])]),t(Re,{meetings:y.value,loading:M.value,onMeetingClick:se,onViewAll:ie},null,8,["meetings","loading"])])]),t(H,{modelValue:N.value,"onUpdate:modelValue":e[4]||(e[4]=r=>N.value=r),title:"发起会议",width:"450px","close-on-click-modal":!1},{footer:a(()=>[t(x,{onClick:e[3]||(e[3]=r=>N.value=!1)},{default:a(()=>[...e[14]||(e[14]=[w("取消",-1)])]),_:1}),t(x,{type:"primary",loading:C.value,onClick:ae},{default:a(()=>[...e[15]||(e[15]=[w("创建会议",-1)])]),_:1},8,["loading"])]),default:a(()=>[t(F,{model:i,"label-width":"100px"},{default:a(()=>[t(b,{label:"会议号类型"},{default:a(()=>[t(de,{modelValue:i.meetingNoType,"onUpdate:modelValue":e[0]||(e[0]=r=>i.meetingNoType=r)},{default:a(()=>[t(B,{value:0},{default:a(()=>[...e[12]||(e[12]=[w("使用个人会议号",-1)])]),_:1}),t(B,{value:1},{default:a(()=>[...e[13]||(e[13]=[w("系统生成会议号",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"会议主题",required:""},{default:a(()=>[t(j,{modelValue:i.meetingName,"onUpdate:modelValue":e[1]||(e[1]=r=>i.meetingName=r),placeholder:"请输入会议主题",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(b,{label:"会议密码"},{default:a(()=>[t(j,{modelValue:i.joinPassword,"onUpdate:modelValue":e[2]||(e[2]=r=>i.joinPassword=r),placeholder:"可选，最多5位",maxlength:"5","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(H,{modelValue:s.value,"onUpdate:modelValue":e[10]||(e[10]=r=>s.value=r),title:"加入会议",width:"400px","close-on-click-modal":!1},{footer:a(()=>[t(x,{onClick:e[9]||(e[9]=r=>s.value=!1)},{default:a(()=>[...e[16]||(e[16]=[w("取消",-1)])]),_:1}),t(x,{type:"primary",loading:l.value,onClick:le},{default:a(()=>[...e[17]||(e[17]=[w("加入会议",-1)])]),_:1},8,["loading"])]),default:a(()=>[t(F,{model:o,"label-width":"100px"},{default:a(()=>[t(b,{label:"会议号",required:""},{default:a(()=>[t(j,{modelValue:o.meetingNo,"onUpdate:modelValue":e[5]||(e[5]=r=>o.meetingNo=r),placeholder:"请输入10位会议号",maxlength:"10"},null,8,["modelValue"])]),_:1}),t(b,{label:"昵称",required:""},{default:a(()=>[t(j,{modelValue:o.nickName,"onUpdate:modelValue":e[6]||(e[6]=r=>o.nickName=r),placeholder:"请输入昵称",maxlength:"20"},null,8,["modelValue"])]),_:1}),t(b,{label:"会议密码"},{default:a(()=>[t(j,{modelValue:o.joinPassword,"onUpdate:modelValue":e[7]||(e[7]=r=>o.joinPassword=r),placeholder:"如需密码请输入",maxlength:"5","show-password":""},null,8,["modelValue"])]),_:1}),t(b,{label:"开启摄像头"},{default:a(()=>[t(re,{modelValue:o.videoOpen,"onUpdate:modelValue":e[8]||(e[8]=r=>o.videoOpen=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}}),ut=U(lt,[["__scopeId","data-v-434819a1"]]);export{ut as default};
